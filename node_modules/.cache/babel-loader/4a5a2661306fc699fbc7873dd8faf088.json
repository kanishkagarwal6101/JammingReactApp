{"ast":null,"code":"let usrToken;\nconst clientID = \"6a75ad4ead464369ac6e2d63b7293964\";\nconst redirectURI = \"http://localhost:3000/\";\nlet Spotify = {\n  getAccessToken() {\n    if (usrToken) {\n      return usrToken;\n    }\n\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\n\n    if (accessTokenMatch && expiresInMatch) {\n      usrToken = accessTokenMatch[1];\n      const expiresIn = Number(expiresInMatch[1]);\n      window.setTimeout(() => usrToken = \"\", expiresIn * 1000);\n      window.history.pushState(\"Access Token\", null, \"/\");\n      return usrToken;\n    } else {\n      window.location(`https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURI}`);\n    }\n  },\n\n  search(searchTerm) {\n    return fetch(`https://api.spotify.com/v1/search?type=track&q=${searchTerm}`, {\n      headers: {\n        Authorization: `Bearer ${usrToken}`\n      }\n    }).then(response => response.json()).then(jsonReponse => {\n      if (!jsonReponse.tracks) {\n        return [];\n      }\n\n      return jsonReponse.tracks.items.map(track => ({\n        id: track.id,\n        name: track.name,\n        artist: track.artists[0].name,\n        album: track.album.name,\n        uri: track.uri\n      }));\n    });\n  },\n\n  savePlaylist(name, arr) {\n    if (!name || arr.length === 0) {\n      return;\n    }\n\n    const accessToken = Spotify.getAccessToken();\n    const headers = {\n      Authorization: `Bearer ${accessToken}`\n    };\n    let userId;\n    return fetch(\"https://api.spotify.com/v1/me\", {\n      headers: headers\n    }).then(response => response.json()).then(jsonResponse => {\n      userId = jsonResponse.id;\n      return fetch(`https://api.spotify.com/v1/users/${userId}/playlists`, {\n        headers: headers,\n        method: \"POST\",\n        body: JSON.stringify({\n          name: name\n        })\n      });\n    }).then(response => response.json()).then(jsonReponse => {\n      const playlistId = jsonReponse.id;\n      return fetch(`https://api.spotify.com/v1/users/${userId}/playlists/${playlistId}/tracks`, {\n        headers: headers,\n        method: \"POST\",\n        body: JSON.stringify({\n          uris: arr\n        })\n      });\n    });\n  }\n\n};\nmodule.exports = Spotify;","map":{"version":3,"sources":["D:/web development/codecademy/React Music App/reactmusicappapi/src/util/Spotify.js"],"names":["usrToken","clientID","redirectURI","Spotify","getAccessToken","accessTokenMatch","window","location","href","match","expiresInMatch","expiresIn","Number","setTimeout","history","pushState","search","searchTerm","fetch","headers","Authorization","then","response","json","jsonReponse","tracks","items","map","track","id","name","artist","artists","album","uri","savePlaylist","arr","length","accessToken","userId","jsonResponse","method","body","JSON","stringify","playlistId","uris","module","exports"],"mappings":"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","sourcesContent":["let usrToken;\r\nconst clientID = \"6a75ad4ead464369ac6e2d63b7293964\";\r\nconst redirectURI = \"http://localhost:3000/\";\r\nlet Spotify = {\r\n  getAccessToken() {\r\n    if (usrToken) {\r\n      return usrToken;\r\n    }\r\n    const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);\r\n    const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);\r\n    if (accessTokenMatch && expiresInMatch) {\r\n      usrToken = accessTokenMatch[1];\r\n      const expiresIn = Number(expiresInMatch[1]);\r\n      window.setTimeout(() => (usrToken = \"\"), expiresIn * 1000);\r\n      window.history.pushState(\"Access Token\", null, \"/\");\r\n      return usrToken;\r\n    } else {\r\n      window.location(\r\n        `https://accounts.spotify.com/authorize?client_id=${clientID}&response_type=token&scope=playlist-modify-public&redirect_uri=${redirectURI}`\r\n      );\r\n    }\r\n  },\r\n  search(searchTerm) {\r\n    return fetch(\r\n      `https://api.spotify.com/v1/search?type=track&q=${searchTerm}`,\r\n      {\r\n        headers: { Authorization: `Bearer ${usrToken}` },\r\n      }\r\n    )\r\n      .then((response) => response.json())\r\n      .then((jsonReponse) => {\r\n        if (!jsonReponse.tracks) {\r\n          return [];\r\n        }\r\n        return jsonReponse.tracks.items.map((track) => ({\r\n          id: track.id,\r\n          name: track.name,\r\n          artist: track.artists[0].name,\r\n          album: track.album.name,\r\n          uri: track.uri,\r\n        }));\r\n      });\r\n  },\r\n  savePlaylist(name, arr) {\r\n    if (!name || arr.length === 0) {\r\n      return;\r\n    }\r\n    const accessToken = Spotify.getAccessToken();\r\n    const headers = { Authorization: `Bearer ${accessToken}` };\r\n    let userId;\r\n    return fetch(\"https://api.spotify.com/v1/me\", { headers: headers })\r\n      .then((response) => response.json())\r\n      .then((jsonResponse) => {\r\n        userId = jsonResponse.id;\r\n        return fetch(`https://api.spotify.com/v1/users/${userId}/playlists`, {\r\n          headers: headers,\r\n          method: \"POST\",\r\n          body: JSON.stringify({ name: name }),\r\n        });\r\n      })\r\n      .then((response) => response.json())\r\n      .then((jsonReponse) => {\r\n        const playlistId = jsonReponse.id;\r\n        return fetch(\r\n          `https://api.spotify.com/v1/users/${userId}/playlists/${playlistId}/tracks`,\r\n          {\r\n            headers: headers,\r\n            method: \"POST\",\r\n            body: JSON.stringify({ uris: arr }),\r\n          }\r\n        );\r\n      });\r\n  },\r\n};\r\nmodule.exports = Spotify;\r\n"]},"metadata":{},"sourceType":"module"}